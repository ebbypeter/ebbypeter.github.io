<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Minimize a WPF application to System Tray in C# - How can I do it?</title>
<meta name="description" content="How can I minimize a WPF application to System Tray in C#?">
<meta name="description" content="In this post we will see how we can minimize a WPF application to System Tray using C#.">
<meta name="author" content="Ebby Peter">
<meta name="keywords" content="C#, WPF">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://howcanidoit.in/images/minimize-a-wpf-application/image1.png">
<meta name="twitter:title" content="Minimize a WPF application to System Tray in C#">
<meta name="twitter:description" content="In this post we will see how we can minimize a WPF application to System Tray using C#.">
<meta name="twitter:creator" content="@EbbyPeter">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Minimize a WPF application to System Tray in C#">
<meta property="og:description" content="In this post we will see how we can minimize a WPF application to System Tray using C#.">
<meta property="og:url" content="http://howcanidoit.in/wpf/minimize-a-wpf-application-to-system-tray-in-c">
<meta property="og:site_name" content="How can I do it?">

<meta name="google-site-verification" content="3-GDL4XGJW3KBT2jaHvr0MXkkiaEHd6JTfLSKjPj3gs">
<meta name="msvalidate.01" content="61E4F53D58574CE42FCF77D16F95C06D">


<link rel="canonical" href="http://howcanidoit.in/wpf/minimize-a-wpf-application-to-system-tray-in-c">
<link href="http://howcanidoit.in/feed.xml" type="application/atom+xml" rel="alternate" title="How can I do it? Feed">
<link rel="author" href="https://google.com/+EbbyPeter1?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://howcanidoit.in/assets/css/main.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://howcanidoit.in/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://howcanidoit.in/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://howcanidoit.in/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://howcanidoit.in/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://howcanidoit.in/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://howcanidoit.in/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://howcanidoit.in/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="http://howcanidoit.in">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="http://howcanidoit.in/images/Ebby.jpg" alt="Ebby Peter photo" class="author-photo">
					<h4>Ebby Peter</h4>
					<p>A developer who specializes in SharePoint, WPF, MVC, Windows 8 and Windows Phone Apps; who loves to experiment and learn something new each day, every day.</p>
				</li>
				<li><a href="http://howcanidoit.in/about/">Learn More</a></li>
				<li>
					<a href="mailto:ebby.learning@outlook.com"><i class="fa fa-envelope"></i> Email</a>
				</li>
				<li>
					<a href="http://twitter.com/EbbyPeter"><i class="fa fa-twitter"></i> Twitter</a>
				</li>
				<!--<li>
					<a href="http://facebook.com/EbbyPeter"><i class="fa fa-facebook"></i> Facebook</a>
				</li>
				<li>
					<a href="https://google.com/+EbbyPeter1"><i class="fa fa-google-plus"></i> Google+</a>
				</li>-->
				<li>
					<a href="http://linkedin.com/in/EbbyPeter"><i class="fa fa-linkedin"></i> LinkedIn</a>
				</li>
				<li>
					<a href="http://github.com/EbbyPeter"><i class="fa fa-github"></i> GitHub</a>
				</li>
				
				<!--
				
				-->
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="http://howcanidoit.in/posts/">All Posts</a></li>
				<li><a href="http://howcanidoit.in/tags/">All Tags</a></li>
			</ul>
		</li>
		
	    
	        
	    
	    <li><a href="http://howcanidoit.in/feed.xml" >RSS Feed</a></li>
	  
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->



<div class="entry-header">
    <div class="entry-image">
    <img src="http://howcanidoit.in/images/abstract-11.jpg" alt="Minimize a WPF application to System Tray in C#">
  </div><!-- /.entry-image -->
</div><!-- /.entry-header -->


<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
          <h2><a href="http://howcanidoit.in">How can I do it?</a></h2>
        
          <h1 class="entry-title"><a href="http://howcanidoit.in/wpf/minimize-a-wpf-application-to-system-tray-in-c" rel="bookmark" title="Minimize a WPF application to System Tray in C#">Minimize a WPF application to System Tray in C#</a></h1>
        
        
            <p id="post-description"><i>How can I minimize a WPF application to System Tray in C#?</i></p>
        
        <h2>June 27, 2010</h2>    
        
        <p class="entry-reading-time">
          <i class="fa fa-clock-o"></i>
          
          Reading time ~2 minutes
        </p><!-- /.entry-reading-time -->
        
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
        
            <p>In this post we will see how we can minimize a WPF application to System Tray using C#.</p>
        
      <p>There is no direct way to minimize a WPF application to system tray. This does not means that we cannot do that at all. </p>

<p class="pull-right"><a href="http://howcanidoit.in/images/minimize-a-wpf-application/image1.png"><img src="http://howcanidoit.in/images/minimize-a-wpf-application/thumb/image1.png" alt="image" /></a></p>

<p><br />
To minimize WPF app to System Tray/add the Tray notification, we just need to add the “<code>System.Windows.Forms</code>” and “<code>System.Drawing</code>” assembly references to your WPF project. Once we add the references, we can create new instance of the “NotifyIcon” class and use it in our WPF application.  </p>

<p><br /><br /><br />
After we add the references to the WPF application, we have to create a global variable for <strong>NotifyIcon</strong>.</p>

<div class="highlight"><pre><code class="language-c#" data-lang="c#"><span class="k">private</span> <span class="n">System</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Forms</span><span class="p">.</span><span class="n">NotifyIcon</span> <span class="n">MyNotifyIcon</span><span class="p">;</span></code></pre></div>

<p>Now we have to initiate the NotifyIcon. This can be done in the Window’s constructor. We also have to declare an Event to retrieve back the application from SystemTray.</p>

<div class="highlight"><pre><code class="language-c#" data-lang="c#"><span class="lineno">1</span> <span class="k">public</span> <span class="nf">MainWindow</span><span class="p">()</span>
<span class="lineno">2</span> <span class="p">{</span>
<span class="lineno">3</span>     <span class="n">InitializeComponent</span><span class="p">();</span>
<span class="lineno">4</span>     <span class="n">MyNotifyIcon</span> <span class="p">=</span> <span class="k">new</span> <span class="n">System</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Forms</span><span class="p">.</span><span class="n">NotifyIcon</span><span class="p">();</span>
<span class="lineno">5</span>     <span class="n">MyNotifyIcon</span><span class="p">.</span><span class="n">Icon</span> <span class="p">=</span> <span class="k">new</span> <span class="n">System</span><span class="p">.</span><span class="n">Drawing</span><span class="p">.</span><span class="n">Icon</span><span class="p">(</span><span class="s">@&quot;C:\Archive\Icon-Archive.ico&quot;</span><span class="p">);</span>
<span class="lineno">6</span>     <span class="n">MyNotifyIcon</span><span class="p">.</span><span class="n">MouseDoubleClick</span> <span class="p">+=</span> 
<span class="lineno">7</span>         <span class="k">new</span> <span class="n">System</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Forms</span><span class="p">.</span><span class="n">MouseEventHandler</span><span class="p">(</span><span class="n">MyNotifyIcon_MouseDoubleClick</span><span class="p">);</span>
<span class="lineno">8</span> <span class="p">}</span></code></pre></div>

<p>To minimize the application to the system tray we need to handle the appropriate events. There are multiple events that can be used to achieve the output… The most appropriate will be the <code>Form SizeChanged</code> event.</p>

<p>To revive the app back we need to write a couple more lines. This time the event to be handled is <code>NotifyIcon MouseDoubleClick</code> or <code>NotifyIcon MouseClick</code>.</p>

<div class="highlight"><pre><code class="language-c#" data-lang="c#"><span class="lineno"> 1</span> <span class="k">void</span> <span class="nf">MyNotifyIcon_MouseDoubleClick</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Forms</span><span class="p">.</span><span class="n">MouseEventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="lineno"> 2</span> <span class="p">{</span>
<span class="lineno"> 3</span>     <span class="k">this</span><span class="p">.</span><span class="n">WindowState</span> <span class="p">=</span> <span class="n">WindowState</span><span class="p">.</span><span class="n">Normal</span><span class="p">;</span>
<span class="lineno"> 4</span> <span class="p">}</span>
<span class="lineno"> 5</span>     
<span class="lineno"> 6</span> <span class="k">private</span> <span class="k">void</span> <span class="nf">Window_StateChanged</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="lineno"> 7</span> <span class="p">{</span>
<span class="lineno"> 8</span>     <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">WindowState</span> <span class="p">==</span> <span class="n">WindowState</span><span class="p">.</span><span class="n">Minimized</span><span class="p">)</span>
<span class="lineno"> 9</span>     <span class="p">{</span>
<span class="lineno">10</span>         <span class="k">this</span><span class="p">.</span><span class="n">ShowInTaskbar</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">11</span>         <span class="n">MyNotifyIcon</span><span class="p">.</span><span class="n">BalloonTipTitle</span> <span class="p">=</span> <span class="s">&quot;Minimize Sucessful&quot;</span><span class="p">;</span>
<span class="lineno">12</span>         <span class="n">MyNotifyIcon</span><span class="p">.</span><span class="n">BalloonTipText</span> <span class="p">=</span> <span class="s">&quot;Minimized the app&quot;</span><span class="p">;</span>
<span class="lineno">13</span>         <span class="n">MyNotifyIcon</span><span class="p">.</span><span class="n">ShowBalloonTip</span><span class="p">(</span><span class="m">400</span><span class="p">);</span>
<span class="lineno">14</span>         <span class="n">MyNotifyIcon</span><span class="p">.</span><span class="n">Visible</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno">15</span>     <span class="p">}</span>
<span class="lineno">16</span>     <span class="k">else</span> <span class="nf">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">WindowState</span> <span class="p">==</span> <span class="n">WindowState</span><span class="p">.</span><span class="n">Normal</span><span class="p">)</span>
<span class="lineno">17</span>     <span class="p">{</span>
<span class="lineno">18</span>         <span class="n">MyNotifyIcon</span><span class="p">.</span><span class="n">Visible</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
<span class="lineno">19</span>         <span class="k">this</span><span class="p">.</span><span class="n">ShowInTaskbar</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
<span class="lineno">20</span>     <span class="p">}</span>
<span class="lineno">21</span> <span class="p">}</span></code></pre></div>

<div class="note tip">
  <h5>Tip</h5>
  <p>If you are not interested in the balloon tip, we can omit the BalloonTip and ShowBalloon lines. </p>
</div>

      <footer class="entry-meta">
        <span class="entry-tags"><a href="http://howcanidoit.in/tags/#C#" title="Pages tagged C#" class="tag">C#</a><a href="http://howcanidoit.in/tags/#WPF" title="Pages tagged WPF" class="tag">WPF</a></span>
        <span><a href="http://howcanidoit.in/wpf/minimize-a-wpf-application-to-system-tray-in-c" rel="bookmark" title="Minimize a WPF application to System Tray in C#">Minimize a WPF application to System Tray in C#</a> was published on <span class="entry-date date published updated"><time datetime="2010-06-27T00:00:00+12:00">June 27, 2010</time></span></span>
        (revised: <span class="entry-date date modified"><time datetime="2014-11-09">November 09, 2014</time></span>)
        <span class="author vcard"><span class="fn"><a href="http://howcanidoit.in/about/" title="About Ebby Peter">Ebby Peter</a></span></span>
        <div class="social-share">
  <ul class="socialcount socialcount-small inline-list">
    <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=http://howcanidoit.in/wpf/minimize-a-wpf-application-to-system-tray-in-c" title="Share on Facebook"><span class="count"><i class="fa fa-facebook-square"></i> Like</span></a></li>
    <li class="twitter"><a href="https://twitter.com/intent/tweet?text=http://howcanidoit.in/wpf/minimize-a-wpf-application-to-system-tray-in-c" title="Share on Twitter"><span class="count"><i class="fa fa-twitter-square"></i> Tweet</span></a></li>
    <li class="googleplus"><a href="https://plus.google.com/share?url=http://howcanidoit.in/wpf/minimize-a-wpf-application-to-system-tray-in-c" title="Share on Google Plus"><span class="count"><i class="fa fa-google-plus-square"></i> +1</span></a></li>
  </ul>
</div><!-- /.social-share -->
      </footer>
    </div><!-- /.entry-content -->
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
    <div class="read-more">
  
    <div class="read-more-header">
      <a href="http://howcanidoit.in/c%23/minimize-an-application-to-system-tray-in-c" class="read-more-btn">Read More</a>
    </div><!-- /.read-more-header -->
    <div class="read-more-content">
      <h3><a href="http://howcanidoit.in/sharepoint/Show-Popups-Programatically-in-SharePoint" title="Show Dialog box / Popups programmatically in SharePoint 2013">Show Dialog box / Popups programmatically in SharePoint 2013</a></h3>
      <p>How can I display a dialog box / popup in SharePoint 2013 programatically? <a href="http://howcanidoit.in/sharepoint/Show-Popups-Programatically-in-SharePoint">Continue reading</a></p>
    </div><!-- /.read-more-content -->
  
  <div class="read-more-list">
    
      <div class="list-item">
        <h4><a href="http://howcanidoit.in/offbeat/my-shiny-new-blog-site" title="My shiny new blog site">My shiny new blog site</a></h4>
        <span>Published on November 10, 2014</span>
      </div><!-- /.list-item -->
    
      <div class="list-item">
        <h4><a href="http://howcanidoit.in/sample/post-template" title="Post Template">Post Template</a></h4>
        <span>Published on November 08, 2014</span>
      </div><!-- /.list-item -->
    
  </div><!-- /.read-more-list -->
</div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2014 <a href="/about/">Ebby Peter</a> | Published under <a href="/license/">MIT License</a> | Powered by <a href="http://jekyllrb.com">Jekyll</a></span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://howcanidoit.in/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://howcanidoit.in/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56540581-1', 'auto');  
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>



    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'ebbypeter'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
	        

</body>
</html>
